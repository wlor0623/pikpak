import{d as k,r as o,m as A,o as c,s as h,c as D,w as v,e as i,ak as F,b as f,M as N,F as x,U as p,G as P,B as U,y as m,A as b,ag as w,a3 as C,D as O}from"./vendor.60359f7c.js";import{n as T,i as L}from"./index.9b66aca6.js";const M={class:"list-page"},S=m(" \u8BF7\u5148\u5728\u6587\u4EF6\u5217\u8868\u64CD\u4F5C\u9009\u62E9\u8BBE\u7F6E\u9ED8\u8BA4 "),H=x("br",null,null,-1),z={key:0,class:"loading"},V=m("\u52A0\u8F7D\u4E2D "),K=k({setup(Y){const r=o([]),s=o(),n=o(!1),l=o(),E=()=>{n.value=!0,T.post("https://api.notion.com/v1/databases/f90e8e28b55e423185f44c89c53c573c/query",{start_cursor:l.value||void 0,page_size:50}).then(t=>{if(n.value=!1,l.value||(s.value=[]),s.value=s.value.concat(t.data.results),l.value=t.data.has_more&&t.data.next_cursor,r.value.length==0){if(s.value.length)for(let e in s.value[0].properties)e!=="\u53D1\u5E03\u4EBA"&&e!=="\u53D1\u5E03\u65E5\u671F"&&e!=="\u5206\u7C7B"&&e!=="\u6807\u7B7E"&&r.value.push({title:e,key:e,ellipsis:{tooltip:{placement:e==="\u540D\u79F0"?"right":"bottom"}},width:e==="\u5927\u5C0F"?100:e==="\u540D\u79F0"?1e3:void 0,render:u=>{const a=u.properties[e];switch(a.type){case"rich_text":case"title":return p("div",{},{default:()=>a[a.type]&&a[a.type].length&&a[a.type].map(B=>B.plain_text)});case"select":return p("div",{style:{color:u.properties[e].select.color}},a.select.name);case"created_time":return p(P,{time:new Date(a.created_time),type:"date",format:"MM-dd HH:MM"});default:return"--"}}});r.value.push({title:"\u64CD\u4F5C",key:"action",width:80,align:"right",render:e=>p(U,{type:"primary",onClick:()=>{y(e.properties.\u94FE\u63A5.rich_text[0].plain_text)}},{default:()=>"\u4FDD\u5B58"})})}})},d=o(),_=()=>JSON.parse(window.localStorage.getItem("pikpakUploadFolder")||"{}"),y=t=>{let e={};if(!_().id)return window.$message.error("\u8BF7\u5148\u8BBE\u7F6E\u9ED8\u8BA4\u4E0A\u4F20\u76EE\u5F55"),!1;if(t.indexOf("PikPak://")===0){const u=t.substring(9).split("|");e={kind:"drive#file",parent_id:_().id,name:u[0],size:u[1],hash:u[2],upload_type:"UPLOAD_TYPE_RESUMABLE",objProvider:{provider:"UPLOAD_TYPE_UNKNOWN"}}}else e={kind:"drive#file",name:"",upload_type:"UPLOAD_TYPE_URL",url:{url:t},params:{from:"file"},folder_type:"DOWNLOAD"};L.post("https://api-drive.mypikpak.com/drive/v1/files",e).then(u=>{(u.data.upload_type==="UPLOAD_TYPE_UNKNOWN"||t.indexOf("PikPak://")===-1)&&window.$message.success("\u6DFB\u52A0\u6210\u529F")})},g=t=>{t.target.offsetHeight-t.target.scrollTop<30&&l.value&&!n.value&&E()};return A(()=>{d.value=_(),l.value="",E()}),(t,e)=>(c(),h("div",M,[!d.value||!d.value.id?(c(),D(i(F),{key:0,title:"\u8BF7\u5148\u8BBE\u7F6E\u9ED8\u8BA4\u4E0A\u4F20\u76EE\u5F55",type:"error"},{default:v(()=>[S]),_:1})):(c(),D(i(F),{key:1,title:"\u9ED8\u8BA4\u76EE\u5F55",type:"success"},{default:v(()=>[m(b(d.value.name),1)]),_:1})),H,f(i(N),{style:{"max-height":"calc(100vh - 300px)"},onScroll:g},{default:v(()=>[f(i(w),{bordered:!1,size:"small",data:s.value,columns:r.value},null,8,["data","columns"]),n.value?(c(),h("div",z,[f(i(C),{size:"small"}),V])):O("",!0)]),_:1})]))}});export{K as default};
